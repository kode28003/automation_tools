# 🧪 実験データ解析ツール

## 🎯 Goal

本ツールは、**2つのExcelファイルを入力**し、**実験時間をポップアップから入力**することで、  
ピークおよび脈拍数のグラフを自動生成し、さらに **OxyTrueとの比較グラフ** を表示することを目的としています。

------

## ⚙️ 主な機能

### 🧩 データ入力
- 2つのExcelファイル（実験データ、OxyTrueデータ）を読み込み  
- 実験時間をポップアップ入力で指定  

---

### 📊 グラフ表示
- ピークおよび脈拍数の推移を可視化  
- OxyTrueとの比較グラフを自動生成  

---

### 🔧 自動処理機能
本ツールは以下の手順でデータを解析・処理します。  

1. **2波長の同じ時間の脈波振幅の比率を計算**  
   - 測定した2波長の脈波信号から、同時刻のピーク振幅比を算出  

2. **SpO₂と脈波振幅比率の推移を比較**  
   - 実験データとOxyTrueデータの変動をグラフで比較し、相関を確認  

3. **SpO₂と脈波振幅比率から推定式を作成**  
   - 比率とSpO₂値をもとに回帰分析を行い、SpO₂推定式を自動生成  

4. **事前登録した推定式と脈波振幅比率からSpO₂を推定**  
   - 既存の推定モデルを適用して、SpO₂をリアルタイムに推定  

5. **従来法のSpO₂と推定したSpO₂の時間的変化を比較**  
   - OxyTrueなどの実測値と、推定値の時間変化を同一グラフ上で表示  

---


## result
<img width="640" height="480" alt="cutted_median_fit_with_weight" src="https://github.com/user-attachments/assets/abdcc996-04cd-4d9c-bbae-c5b5f7936e00" />
<img width="1000" height="600" alt="compSpO2_base_slope_117 99_cutted" src="https://github.com/user-attachments/assets/e19b1c00-a937-4d50-9c74-a76a901ca3e0" />
